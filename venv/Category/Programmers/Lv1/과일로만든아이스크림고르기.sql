-- 코드를 입력하세요
SELECT F.FLAVOR
FROM FIRST_HALF F INNER JOIN (SELECT FLAVOR
     FROM ICECREAM_INFO
     WHERE INGREDIENT_TYPE='fruit_based') TMP
    ON F.FLAVOR=TMP.FLAVOR
WHERE F.TOTAL_ORDER>3000
ORDER BY F.TOTAL_ORDER DESC;

SELECT FLAVOR
FROM FIRST_HALF
WHERE TOTAL_ORDER>3000
    AND FLAVOR IN (
        SELECT FLAVOR
        FROM ICECREAM_INFO
        WHERE INGREDIENT_TYPE = 'fruit_based'
    )
ORDER BY TOTAL_ORDER DESC;